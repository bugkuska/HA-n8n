title: SmartMeter-Masonry
sections: []
type: masonry
cards:
  - type: entities
    title: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (Energy Data)
    entities:
      - entity: sensor.esp32_pzem016_powermon_voltage
        name: ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (V)
        icon: mdi:alpha-v-circle-outline
        secondary_info: last-updated
      - entity: sensor.esp32_pzem016_powermon_current
        name: ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (A)
        icon: mdi:alpha-a-circle-outline
        secondary_info: last-updated
      - entity: sensor.esp32_pzem016_powermon_power
        name: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (W)
        icon: mdi:flash
        secondary_info: last-updated
      - entity: sensor.esp32_pzem016_powermon_frequency
        name: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà (Hz)
        icon: mdi:sine-wave
        secondary_info: last-updated
      - entity: sensor.esp32_pzem016_powermon_power_factor
        name: Power Factor
        icon: mdi:chart-bell-curve
        secondary_info: last-updated
      - entity: sensor.esp32_pzem016_powermon_total_daily_energy
        name: ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (kWh)
        icon: mdi:calendar-today
        secondary_info: last-updated
      - entity: sensor.monthly_energy_pea_display
        name: ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA (kWh)
        icon: mdi:calendar-sync
        secondary_info: last-changed
  - type: entities
    title: ‡∏ö‡∏¥‡∏•‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (Electricity Bill) - ‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA
    entities:
      - entity: sensor.pea_billing_period_th
        name: ‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA
        icon: mdi:calendar-range
      - entity: sensor.monthly_energy_pea_display
        name: ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA (kWh)
        icon: mdi:flash-outline
      - type: section
        label: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA)
      - entity: sensor.cost_150
        name: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü 150 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏£‡∏Å
        icon: mdi:cash-100
        secondary_info: last-updated
      - entity: sensor.cost_250
        name: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà 151‚Äì400
        icon: mdi:cash-100
        secondary_info: last-updated
      - entity: sensor.cost_400
        name: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà 400 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
        icon: mdi:cash-100
        secondary_info: last-updated
      - type: section
        label: ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA)
      - entity: sensor.base_cost
        name: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ê‡∏≤‡∏ô (‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢)
        icon: mdi:cash
        secondary_info: last-updated
      - entity: input_number.servicecharge
        name: ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
        icon: mdi:cash-plus
      - entity: sensor.base_cost_services_charge
        name: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ê‡∏≤‡∏ô (‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£)
        icon: mdi:cash-100
        secondary_info: last-updated
      - entity: input_number.ftcharge
        name: ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡πà‡∏≤ FT (‡∏ö‡∏≤‡∏ó/‡∏´‡∏ô‡πà‡∏ß‡∏¢)
        icon: mdi:flash-outline
      - entity: sensor.ft_cost
        name: ‡∏Ñ‡πà‡∏≤ FT
        icon: mdi:cash-100
        secondary_info: last-updated
      - entity: sensor.sub_total_before_vat
        name: ‡∏£‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô VAT (‡∏ê‡∏≤‡∏ô+‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£+FT)
        icon: mdi:cash-plus
        secondary_info: last-updated
      - entity: sensor.vat_7_percent
        name: VAT 7%
        icon: mdi:percent
        secondary_info: last-updated
      - type: divider
      - entity: sensor.total_cost
        name: ‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Total) ‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA
        icon: mdi:cash-check
        secondary_info: last-updated
  - type: picture-elements
    elements:
      - type: custom:button-card
        entity: sensor.esp32_pzem016_powermon_power
        show_name: false
        show_icon: false
        show_state: true
        state_display: |
          [[[
            const w = Number(entity.state) || 0;
            if (w >= 1000) return (w/1000).toFixed(2) + ' kW';
            return w.toFixed(0) + ' W';
          ]]]
        style:
          top: 29%
          left: 50.5%
          width: 95%
          transform: translate(-50%, -50%)
        styles:
          card:
            - background: none
            - box-shadow: none
            - border-radius: 0px
            - padding: 0px
          state:
            - font-weight: 800
            - font-size: |
                [[[
                  const w = Number(entity.state) || 0;
                  if (w >= 1000) return '64px';
                  if (w >= 500)  return '56px';
                  return '50px';
                ]]]
            - color: |
                [[[
                  const w = Number(entity.state) || 0;
                  if (w >= 1000) return '#ff4d4d';  // ‡πÅ‡∏î‡∏á
                  if (w >= 500)  return '#ffcc00';  // ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
                  return '#00ff99';                 // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                ]]]
            - text-shadow: 2px 2px 6px rgba(0,0,0,0.85)
            - letter-spacing: 1px
      - type: image
        style:
          top: 46%
          left: 48%
          width: 60%
        camera_view: auto
        image:
          media_content_id: media-source://image_upload/caca79144c67239653094fd83e4c708d
          media_content_type: image/gif
          metadata:
            title: disc.gif
            thumbnail: /api/image/serve/caca79144c67239653094fd83e4c708d/256x256
            media_class: image
            navigateIds:
              - {}
              - media_content_type: app
                media_content_id: media-source://image_upload
      - type: state-label
        entity: sensor.esp32_pzem016_powermon_total_daily_energy
        style:
          top: 59.5%
          left: 30%
          font-size: 18px
          color: white
          font-weight: bold
      - type: state-label
        entity: sensor.esp32_pzem016_powermon_current
        style:
          top: 59.5%
          left: 71%
          font-size: 18px
          color: white
          font-weight: bold
      - type: state-label
        entity: sensor.monthly_energy_pea_display
        style:
          top: 83%
          left: 28%
          font-size: 18px
          color: white
          font-weight: bold
      - type: state-label
        entity: sensor.total_cost
        style:
          top: 83%
          left: 70%
          font-size: 18px
          color: white
          font-weight: bold
    image:
      media_content_id: media-source://image_upload/d5a178c353508f9c83e4cef6f9d88234
      media_content_type: image/png
      metadata:
        title: smartmeter.png
        thumbnail: /api/image/serve/d5a178c353508f9c83e4cef6f9d88234/256x256
        media_class: image
        navigateIds:
          - {}
          - media_content_type: app
            media_content_id: media-source://image_upload
  - type: entities
    title: ‡∏ö‡∏¥‡∏•‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤ (Previous Billing Cycle)
    entities:
      - entity: input_number.pea_prev_bill_kwh
        name: ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤ (kWh)
        icon: mdi:counter
      - entity: input_number.pea_prev_bill_total
        name: ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏£‡∏ß‡∏°‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤ (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
  - type: entities
    title: üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ö‡∏¥‡∏•‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á (6 ‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• PEA)
    show_header_toggle: false
    entities:
      - type: section
        label: ‡∏á‡∏ß‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚Üí ‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î
      - entity: input_number.pea_bill_kwh_1
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1 (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î) ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü (kWh)
        icon: mdi:counter
      - entity: input_number.pea_bill_total_1
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1 (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î) ‚Äì ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
      - type: divider
      - entity: input_number.pea_bill_kwh_2
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 2 ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü (kWh)
        icon: mdi:counter
      - entity: input_number.pea_bill_total_2
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 2 ‚Äì ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
      - type: divider
      - entity: input_number.pea_bill_kwh_3
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 3 ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü (kWh)
        icon: mdi:counter
      - entity: input_number.pea_bill_total_3
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 3 ‚Äì ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
      - type: divider
      - entity: input_number.pea_bill_kwh_4
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 4 ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü (kWh)
        icon: mdi:counter
      - entity: input_number.pea_bill_total_4
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 4 ‚Äì ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
      - type: divider
      - entity: input_number.pea_bill_kwh_5
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 5 ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü (kWh)
        icon: mdi:counter
      - entity: input_number.pea_bill_total_5
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 5 ‚Äì ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
      - type: divider
      - entity: input_number.pea_bill_kwh_6
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 6 (‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î) ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü (kWh)
        icon: mdi:counter
      - entity: input_number.pea_bill_total_6
        name: ‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 6 (‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î) ‚Äì ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ö‡∏≤‡∏ó)
        icon: mdi:cash-check
